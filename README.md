# REST API

Написать backend для магазина с использованием Swagger спецификации. 

### ShopAPI

**Тематика магазина**: магазин бытовой техники.

Имеются следующие сущности:
```
// Клиент
client
{
    id
    client_name
    client_surname
    birthday
    gender
    registration_date
    address_id
}
```
```
// Товар
product
{
    id
    name
    category
    price
    available_stock // число закупленных экземпляров товара
    last_update_date // число последней закупки
    supplier_id
    image_id: UUID
}
```
```
// Поставщики
supplier
{
    id
    name
    address_id
    phone_number
}
```
```
// Изображения товаров
images
{
    id : UUID
    image: bytea
}
```

```
// Адреса

address 
{
    id
    country
    city
    street
}

```
Возможно выделение дополнительных сущностей.

Описанные выше сущности должны быть реализованы в реляционной БД PostgreSQL. По полученным таблицам, в проекте необходимо использовать DAO (Data Access Objects) объекты, для получения данных в репозиториях. 

**Важно**: тебе необходимо подобрать оптимальный тип в СУБД для хранения данных (Для каждого поля столбца)! 

**Подсказка**: для уникальных идентификаторов использовать тип UUID/GUID.


Необходимо реализовать популярные виды HTTP запросов (GET, POST, PUT, DELETE, PATCH).

- Для клиентов:
    
    1) Добавление клиента (на вход подается json, соответствующей структуре, описанной сверху).

    2) Удаление клиента (по его идентификатору)

    3) Получение клиентов по имени и фамилии (параметры — имя и фамилия)

    4) Получение всех клиентов (В данном запросе необходимо предусмотреть опциональные параметры пагинации в строке запроса: limit и offset). В случае отсутствия эти параметров возвращать весь список.

    5) Изменение адреса клиента (параметры: Id и новый адрес в виде json в соответствии с выше описанным форматом)

- Для товаров:

    1) Добавление товара (на вход подается json, соответствующей структуре, описанной сверху).

    2) Уменьшение количества товара (на вход запросу подается id товара и на сколько уменьшить)

    3) Получение товара по id

    4) Получение всех доступных товаров

    5) Удаление товара по id

- Для поставщиков:

    1) Добавление поставщика (на вход подается json, соответствующей структуре, описанной сверху).

    2) Изменение адреса поставщика (параметры: Id и новый адрес в виде json в соответствии с выше описанным форматом)

    3) Удаление поставщика по id

    4) Получение всех поставщиков

    5) Получение поставщика по id

- Для изображений:

    1) добавление изображения (на вход подается byte array изображения и id товара).

    2) Изменение изображения (на вход подается id изображения и новая строка для замены)

    3) Удаление изображения по id изображения

    4) Получение изображения конкретного товара (по id товара) 
   
    5) Получение изображения по id изображения

Методы, возвращающие изображение, должны возвращать изображение (массив байт) с заголовком «application/octet-stream». При этом файл должен автоматически загружаться.


Для каждого из описанных запросов выше, если предусмотрено получение данных в теле на вход, необходимо провести валидацию данных и в случае, если валидация прошла неуспешно — выдавать 400 код ошибки с текстом сообщения.

Если запрос предусматривает обновление данных или получение по Id, необходимо в случае отсутствия данных возвращать код ошибки 404 с текстом сообщения.


Если запрос предусматривает возврат списка данных, то в случае отсутствия данных возвращается пустой список.

Обязательные требования: 
- Полное покрытие методов спецификацией OpenAPI, наличие swagger комментариев и примеров объектов. Swagger спецификация должна отдаваться по пути 
  >http://localhost:{YourPort}/swagger/index.html
- Для коммуникации с API необходимо использовать DTO (Data Transfer Objects). Для преобразования одной модели в другую используй мапперы. Путь к методам контроллеров должен начинаться с приставки 
  >/api/v1/...
- API обязательно должен быть спроектирован по [RESTFUL](https://restfulapi.net/) методологии
- Использование БД для хранения данных, реализация паттерна **Repository** в качестве прослойки доступа к данным.

### Nginx

В данном блоке необходимо:
1. Настроить обратное проксирование на порт своего приложения.
2. Настроить Nginx для работы веб-приложения в части маршрутизации:
  * Настрой маршрутизацию /api -> на /api/v1 разработанной тобой в блоке 2 API.
  * По пути /api/v1 выдавай Swagger.
  * Настроий раздачу статики по пути /. В корне раздачи статики помести 2 файла: index.html и image.png.
  * Настрой /admin на pgAdmin — GUI СУБД POSTGRES.
  * Настрой /status на отдачу страницы статуса сервера Nginx (nginx status).
3. Настрой Nginx в части балансировки: 
  * Запусти еще 2 инстанса бэкенда на других портах с правами доступа в базу данных только на чтение и настроить балансировку GET запросов к /api/v1 (/api/v2) в NGINX на 3 бэкенда в соотношении 2:1:1, где первый — основной бэкенд-сервер. 
4. Настрой кеширование (для всех GET-запросов, кроме /api).
5. Настрой gzip-сжатие в Nginx. Сжатие не должно распространяться на медиа-типы (jpeg, png и т. д.).
6. Настрой HTTPS на локальном устройстве:
  * Создай доменное имя в локальном DNS-сервере. У каждого компьютера есть локальное DNS-хранилище, в котором можно прописать собственное название сайта и по какому адресу этот адрес резолвится. Ты без труда найдешь информацию о том, как это сделать.
  * Создай самоподписанный сертификат с использованием openssl для созданного доменного имени и привязать его в Nginx-конфиге.
  * Настрой reverse proxy на запущенное приложение.
